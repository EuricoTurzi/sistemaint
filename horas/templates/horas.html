
{% extends 'base.html' %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<style>
  .card-custom {
    border-radius: 18px;
    box-shadow: 0 4px 24px rgba(0,0,0,0.08);
    border: none;
    background: #f8f9fa;
  }
  .card-header-custom {
    background: linear-gradient(90deg, #063364 60%, #063364 100%);
    color: #fff;
    border-radius: 18px 18px 0 0;
    border: none;
    padding: 1.2rem 1.5rem;
  }
  .form-label {
    font-weight: 500;
    color: #343a40;
  }
  .form-control, .form-select {
    border-radius: 10px;
    border: 1px solid #dee2e6;
    transition: box-shadow 0.2s;
  }
  .form-control:focus, .form-select:focus {
    box-shadow: 0 0 0 2px #6c63ff33;
    border-color: #6c63ff;
  }
  .input-group-text {
    background: #e9ecef;
    border-radius: 10px 0 0 10px;
    border: none;
    color: #6c63ff;
  }
  .btn-primary {
    background: linear-gradient(90deg, #063364 60%, #063364 100%);
    border: none;
    border-radius: 10px;
    font-weight: 600;
    font-size: 1.1rem;
    box-shadow: 0 2px 8px rgba(108,99,255,0.08);
    transition: background 0.2s;
  }
  .btn-primary:hover {
    background: linear-gradient(90deg, #6c63ff 60%, #007bff 100%);
  }
  .invalid-feedback {
    font-size: 0.95em;
  }
</style>
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-12 col-md-7 col-lg-6">
      <div class="card card-custom">
        <div class="card-header card-header-custom text-center">
          <h4 class="mb-0"><i class="bi bi-clock-history me-2"></i>Cadastrar Horas</h4>
        </div>
        <div class="card-body">
          <form method="POST" enctype="multipart/form-data" autocomplete="off">
            {% csrf_token %}
            {{ form.non_field_errors }}

            <!-- Funcionário -->
            <div class="mb-3">
              <label for="{{ form.funcionario.id_for_label }}" class="form-label">Funcionário</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-person-badge"></i></span>
                <select name="{{ form.funcionario.html_name }}" id="{{ form.funcionario.id_for_label }}" class="form-select">
                  {% for value, label in form.funcionario.field.choices %}
                    <option value="{{ value }}" {% if form.funcionario.value|stringformat:"s" == value|stringformat:"s" %}selected{% endif %}>{{ label }}</option>
                  {% endfor %}
                </select>
              </div>
              {% for error in form.funcionario.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>

            <!-- Hora Inicial -->
            <div class="mb-3">
              <label for="{{ form.hora_inicial.id_for_label }}" class="form-label">Hora Inicial</label>
              <div class="input-group">
                <span class="input-group-text" onclick="fillCurrentDateTime('{{ form.hora_inicial.id_for_label }}')" style="cursor:pointer" title="Preencher com data/hora atual"><i class="bi bi-calendar-plus"></i></span>
                <input type="text"
                       name="{{ form.hora_inicial.html_name }}"
                       id="{{ form.hora_inicial.id_for_label }}"
                       class="form-control"
                       value="{{ form.hora_inicial.value|default:'' }}"
                       placeholder="DD/MM/AAAA HH:MM:SS">
              </div>
              <small class="form-text text-muted">Clique no ícone para preencher com data e hora atual. Formatos aceitos: DD/MM/AAAA HH:MM:SS</small>
              {% for error in form.hora_inicial.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>

            <!-- Hora Final -->
            <div class="mb-3">
              <label for="{{ form.hora_final.id_for_label }}" class="form-label">Hora Final</label>
              <div class="input-group">
                <span class="input-group-text" onclick="fillCurrentDateTime('{{ form.hora_final.id_for_label }}')" style="cursor:pointer" title="Preencher com data/hora atual"><i class="bi bi-calendar-check"></i></span>
                <input type="text"
                       name="{{ form.hora_final.html_name }}"
                       id="{{ form.hora_final.id_for_label }}"
                       class="form-control"
                       value="{{ form.hora_final.value|default:'' }}"
                       placeholder="DD/MM/AAAA HH:MM:SS">
              </div>
              <small class="form-text text-muted">Clique no ícone para preencher com data e hora atual. Formatos aceitos: DD/MM/AAAA HH:MM:SS</small>
              {% for error in form.hora_final.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>

            <!-- Comprovante 1 -->
            <div class="mb-3">
              <label for="{{ form.comprovante1.id_for_label }}" class="form-label">Comprovante 1</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-file-earmark-arrow-up"></i></span>
                <input type="file"
                       name="{{ form.comprovante1.html_name }}"
                       id="{{ form.comprovante1.id_for_label }}"
                       class="form-control">
              </div>
              {% for error in form.comprovante1.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>

            <!-- Comprovante 2 -->
            <div class="mb-3">
              <label for="{{ form.comprovante2.id_for_label }}" class="form-label">Comprovante 2</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-file-earmark-arrow-up"></i></span>
                <input type="file"
                       name="{{ form.comprovante2.html_name }}"
                       id="{{ form.comprovante2.id_for_label }}"
                       class="form-control">
              </div>
              {% for error in form.comprovante2.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>

            <!-- Motivo -->
            <div class="mb-3">
              <label for="{{ form.motivo.id_for_label }}" class="form-label">Motivo</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-chat-left-text"></i></span>
                <input type="text"
                       name="{{ form.motivo.html_name }}"
                       id="{{ form.motivo.id_for_label }}"
                       class="form-control"
                       value="{{ form.motivo.value|default:'' }}">
              </div>
              {% for error in form.motivo.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>

            <!-- Total -->
            <div class="mb-4">
              <label for="{{ form.total.id_for_label }}" class="form-label">Total</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-calculator"></i></span>
                <input type="number"
                       step="0.01"
                       name="{{ form.total.html_name }}"
                       id="{{ form.total.id_for_label }}"
                       class="form-control"
                       value="{{ form.total.value|default:'' }}">
              </div>
              {% for error in form.total.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>

            <button type="submit" class="btn btn-primary w-100 mb-2"><i class="bi bi-save me-2"></i>Salvar</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
function fillCurrentDateTime(fieldId) {
  var now = new Date();
  var year = now.getFullYear();
  var month = ('0' + (now.getMonth() + 1)).slice(-2);
  var day = ('0' + now.getDate()).slice(-2);
  var hours = ('0' + now.getHours()).slice(-2);
  var minutes = ('0' + now.getMinutes()).slice(-2);
  var seconds = ('0' + now.getSeconds()).slice(-2);
  var dateTimeString = day + '/' + month + '/' + year + ' ' + hours + ':' + minutes + ':' + seconds;
  document.getElementById(fieldId).value = dateTimeString;
}
function fillCurrentDate(fieldId) {
  var now = new Date();
  var year = now.getFullYear();
  var month = ('0' + (now.getMonth() + 1)).slice(-2);
  var day = ('0' + now.getDate()).slice(-2);
  var dateString = day + '/' + month + '/' + year;
  document.getElementById(fieldId).value = dateString;
}
function fillCurrentDateTimeInternational(fieldId) {
  var now = new Date();
  var year = now.getFullYear();
  var month = ('0' + (now.getMonth() + 1)).slice(-2);
  var day = ('0' + now.getDate()).slice(-2);
  var hours = ('0' + now.getHours()).slice(-2);
  var minutes = ('0' + now.getMinutes()).slice(-2);
  var seconds = ('0' + now.getSeconds()).slice(-2);
  var dateTimeString = year + '-' + month + '-' + day + ' ' + hours + ':' + minutes + ':' + seconds;
  document.getElementById(fieldId).value = dateTimeString;
}
</script>
{% endblock %}
